---
title: "Pilot Study - 2x3 Design (Cond x Base)"
date: '`r format(Sys.Date(), "%B %d, %Y")`'
output:
  pdf_document:
    toc: yes
    toc_depth: 2
    fig_caption: true
header-includes:
  \renewcommand{\contentsname}{Items}
  \usepackage{fvextra}
  \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
---

```{r setup, include=FALSE}
rm(list=ls())
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE,
	results = "hide"
)
library(dplyr)
library(lmtest)
library(sandwich)
library(systemfit)
library(car)
library(broom)
library(qualtRics)
library(knitr)
library(rmarkdown)
library(tidyverse)
```

```{r include=FALSE}
qualtrics_api_credentials(api_key = "BJ6aDiEgtQihneCgtZycVLYjaj0ao9gYkdRkb1UZ",
                          base_url = "yul1.qualtrics.com",
                          install = F,
                          overwrite = T)
if ( (!is.null(knitr::current_input()))) {
  if (("pdf_document" ==
                rmarkdown::all_output_formats(knitr::current_input())[1])) {
      stargazer_type <- "latex"
  }
} else {
  stargazer_type <- "text"
}

robust_summary <- function(model) {
    # Calculating robust standard errors
    robust_se <- sqrt(diag(vcovHC(model, type = "HC3")))

    # Getting original model summary
    model_summary <- summary(model)

    # Updating standard errors, t-values, and p-values in the coefficients table
    model_summary$coefficients[, "Std. Error"] <- robust_se
    model_summary$coefficients[, "t value"] <- model_summary$coefficients[, "Estimate"] / robust_se
    model_summary$coefficients[, "Pr(>|t|)"] <- 2 * pt(-abs(model_summary$coefficients[, "t value"]), df = model_summary$df[2], lower.tail = TRUE)

    return(model_summary)
}
robust_confint <- function(model, level = 0.95) {
    # Calculating robust standard errors
    robust_se <- sqrt(diag(vcovHC(model, type = "HC3")))

    # Getting the coefficients
    est <- coef(model)

    # Calculating the critical value for the t-distribution
    alpha <- 1 - level
    t_crit <- qt(1 - alpha / 2, df = df.residual(model))

    # Calculating the confidence intervals
    lower <- est - t_crit * robust_se
    upper <- est + t_crit * robust_se

    # Combining into a matrix
    confint <- cbind(lower, upper)
    rownames(confint) <- names(est)
    colnames(confint) <- c("2.5 %", "97.5 %")

    return(confint)
}
extract_regression_estimates <- function(model) {
  # Get robust summary
  rob_sum <- robust_summary(model)
  # Get robust confidence intervals
  rob_ci <- robust_confint(model)

  # Extract coefficient for the treatment variable (second row)
  estimate <- rob_sum$coefficients[2, "Estimate"] * 100  # Convert to percentage points
  se <- rob_sum$coefficients[2, "Std. Error"] * 100
  ci_lower <- rob_ci[2, 1] * 100
  ci_upper <- rob_ci[2, 2] * 100

  return(list(
    estimate = estimate,
    se = se,
    ci_lower = ci_lower,
    ci_upper = ci_upper
  ))
}
```

\newpage

## Read Data

```{r echo=TRUE}
# Set this to TRUE if you have API access, FALSE if using CSV
USE_API <- T

if(USE_API) {
  ## Pull directly from Qualtrics API
  qual_data <- fetch_survey(surveyID='SV_dpbDBoF9oHm8TXw',  # Pilot Study ID
                            start_date = "2025-10-27",
                     force_request = T)
} else {
  # Read the processed data directly from CSV
  d0 <- read.csv('pilot-study.csv', check.names = F)
  num_excluded <- unique(d0$num_excluded_total)
}

# Define the categories based on the JavaScript feedback code
# Low base categories (3 authors each) - SetA
categories_low <- list(
  women = c('Zadie Smith','J.K. Rowling','Jane Austen'),
  poets = c('George Orwell','Flann O\'Brien','Neil Gaiman'),
  oldies = c('Ernest Hemingway','Nathaniel Hawthorne','F. Scott Fitzgerald'),
  books = c('John Steinbeck','Michael Crichton','Kurt Vonnegut')
)

# Medium base categories (6 authors each) - SetB
categories_med <- list(
  women = c('Zadie Smith','J.K. Rowling','Jane Austen','Joyce Carol Oates','Sylvia Plath','Virginia Woolf'),
  poets = c('Charles Dickens','George Orwell','Sylvia Plath','Flann O\'Brien','Neil Gaiman','Oscar Wilde'),
  oldies = c('Charles Dickens','Ernest Hemingway','Nathaniel Hawthorne','F. Scott Fitzgerald','Virginia Woolf','Oscar Wilde'),
  books = c('Charles Dickens','John Steinbeck','Joyce Carol Oates','Michael Crichton','Ray Bradbury','Kurt Vonnegut')
)

# High base categories (9 authors each) - SetC
categories_high <- list(
  women = c('Zadie Smith','J.K. Rowling','Jane Austen','Maya Angelou','Joyce Carol Oates','Sylvia Plath','Lucy Maud','Isabel Allende','Virginia Woolf'),
  poets = c('Charles Dickens','Victor Hugo','George Orwell','Maya Angelou','Sylvia Plath','Flann O\'Brien','Jorge Luis Borges','Neil Gaiman','Oscar Wilde'),
  oldies = c('Charles Dickens','Ernest Hemingway','Victor Hugo','Nathaniel Hawthorne','Lucy Maud','F. Scott Fitzgerald','Jorge Luis Borges','Virginia Woolf','Oscar Wilde'),
  books = c('Charles Dickens','John Steinbeck','Joyce Carol Oates','Lucy Maud','Isabel Allende','Jorge Luis Borges','Ray Bradbury','Kurt Vonnegut','Michael Crichton')
)

if(USE_API) {
  # Process the API data with new category definitions
  d0 <- qual_data |>
    filter(!is.na(`choice-7`), !is.na(PROLIFIC_PID)) |>
    mutate(
      # Extract base condition from embedded data
      base_condition = tolower(base),

      # Gender feedback detection (cond == "treat")
      gender_feedback = as.numeric(cond == "treat"),

      # Attribute feedback detection based on JavaScript code
      poets_shown = as.numeric(grepl("wrote poetry", feedbackItem1) |
                   grepl("wrote poetry", feedbackItem2) |
                   grepl("wrote poetry", feedbackItem3)),

      oldies_shown = as.numeric(grepl("born in the 1800s", feedbackItem1) |
                     grepl("born in the 1800s", feedbackItem2) |
                     grepl("born in the 1800s", feedbackItem3)),

      books_shown = as.numeric(grepl("wrote more than 10 books", feedbackItem1) |
                     grepl("wrote more than 10 books", feedbackItem2) |
                     grepl("wrote more than 10 books", feedbackItem3)),

      women_shown = as.numeric(grepl("were women", feedbackItem1) |
                    grepl("were women", feedbackItem2) |
                    grepl("were women", feedbackItem3))
    )

  # Calculate picks based on the appropriate category list
  for(i in 1:nrow(d0)) {
    if(d0$base_condition[i] == "high") {
      d0$female_pick[i] <- as.numeric(d0$`choice-7`[i] %in% categories_high$women)
      d0$poets_pick[i] <- as.numeric(d0$`choice-7`[i] %in% categories_high$poets)
      d0$oldies_pick[i] <- as.numeric(d0$`choice-7`[i] %in% categories_high$oldies)
      d0$books_pick[i] <- as.numeric(d0$`choice-7`[i] %in% categories_high$books)

      # Calculate base counts for initial selections
      d0$base_gender[i] <- sum(d0$`choice-1`[i] %in% categories_high$women,
                               d0$`choice-2`[i] %in% categories_high$women,
                               d0$`choice-3`[i] %in% categories_high$women,
                               d0$`choice-4`[i] %in% categories_high$women,
                               d0$`choice-5`[i] %in% categories_high$women,
                               d0$`choice-6`[i] %in% categories_high$women)
      d0$base_poets[i] <- sum(d0$`choice-1`[i] %in% categories_high$poets,
                              d0$`choice-2`[i] %in% categories_high$poets,
                              d0$`choice-3`[i] %in% categories_high$poets,
                              d0$`choice-4`[i] %in% categories_high$poets,
                              d0$`choice-5`[i] %in% categories_high$poets,
                              d0$`choice-6`[i] %in% categories_high$poets)
      d0$base_oldies[i] <- sum(d0$`choice-1`[i] %in% categories_high$oldies,
                               d0$`choice-2`[i] %in% categories_high$oldies,
                               d0$`choice-3`[i] %in% categories_high$oldies,
                               d0$`choice-4`[i] %in% categories_high$oldies,
                               d0$`choice-5`[i] %in% categories_high$oldies,
                               d0$`choice-6`[i] %in% categories_high$oldies)
      d0$base_books[i] <- sum(d0$`choice-1`[i] %in% categories_high$books,
                              d0$`choice-2`[i] %in% categories_high$books,
                              d0$`choice-3`[i] %in% categories_high$books,
                              d0$`choice-4`[i] %in% categories_high$books,
                              d0$`choice-5`[i] %in% categories_high$books,
                              d0$`choice-6`[i] %in% categories_high$books)
    } else if(d0$base_condition[i] == "med") {
      d0$female_pick[i] <- as.numeric(d0$`choice-7`[i] %in% categories_med$women)
      d0$poets_pick[i] <- as.numeric(d0$`choice-7`[i] %in% categories_med$poets)
      d0$oldies_pick[i] <- as.numeric(d0$`choice-7`[i] %in% categories_med$oldies)
      d0$books_pick[i] <- as.numeric(d0$`choice-7`[i] %in% categories_med$books)

      # Calculate base counts for initial selections
      d0$base_gender[i] <- sum(d0$`choice-1`[i] %in% categories_med$women,
                               d0$`choice-2`[i] %in% categories_med$women,
                               d0$`choice-3`[i] %in% categories_med$women,
                               d0$`choice-4`[i] %in% categories_med$women,
                               d0$`choice-5`[i] %in% categories_med$women,
                               d0$`choice-6`[i] %in% categories_med$women)
      d0$base_poets[i] <- sum(d0$`choice-1`[i] %in% categories_med$poets,
                              d0$`choice-2`[i] %in% categories_med$poets,
                              d0$`choice-3`[i] %in% categories_med$poets,
                              d0$`choice-4`[i] %in% categories_med$poets,
                              d0$`choice-5`[i] %in% categories_med$poets,
                              d0$`choice-6`[i] %in% categories_med$poets)
      d0$base_oldies[i] <- sum(d0$`choice-1`[i] %in% categories_med$oldies,
                               d0$`choice-2`[i] %in% categories_med$oldies,
                               d0$`choice-3`[i] %in% categories_med$oldies,
                               d0$`choice-4`[i] %in% categories_med$oldies,
                               d0$`choice-5`[i] %in% categories_med$oldies,
                               d0$`choice-6`[i] %in% categories_med$oldies)
      d0$base_books[i] <- sum(d0$`choice-1`[i] %in% categories_med$books,
                              d0$`choice-2`[i] %in% categories_med$books,
                              d0$`choice-3`[i] %in% categories_med$books,
                              d0$`choice-4`[i] %in% categories_med$books,
                              d0$`choice-5`[i] %in% categories_med$books,
                              d0$`choice-6`[i] %in% categories_med$books)
    } else {
      d0$female_pick[i] <- as.numeric(d0$`choice-7`[i] %in% categories_low$women)
      d0$poets_pick[i] <- as.numeric(d0$`choice-7`[i] %in% categories_low$poets)
      d0$oldies_pick[i] <- as.numeric(d0$`choice-7`[i] %in% categories_low$oldies)
      d0$books_pick[i] <- as.numeric(d0$`choice-7`[i] %in% categories_low$books)

      # Calculate base counts for initial selections
      d0$base_gender[i] <- sum(d0$`choice-1`[i] %in% categories_low$women,
                               d0$`choice-2`[i] %in% categories_low$women,
                               d0$`choice-3`[i] %in% categories_low$women,
                               d0$`choice-4`[i] %in% categories_low$women,
                               d0$`choice-5`[i] %in% categories_low$women,
                               d0$`choice-6`[i] %in% categories_low$women)
      d0$base_poets[i] <- sum(d0$`choice-1`[i] %in% categories_low$poets,
                              d0$`choice-2`[i] %in% categories_low$poets,
                              d0$`choice-3`[i] %in% categories_low$poets,
                              d0$`choice-4`[i] %in% categories_low$poets,
                              d0$`choice-5`[i] %in% categories_low$poets,
                              d0$`choice-6`[i] %in% categories_low$poets)
      d0$base_oldies[i] <- sum(d0$`choice-1`[i] %in% categories_low$oldies,
                               d0$`choice-2`[i] %in% categories_low$oldies,
                               d0$`choice-3`[i] %in% categories_low$oldies,
                               d0$`choice-4`[i] %in% categories_low$oldies,
                               d0$`choice-5`[i] %in% categories_low$oldies,
                               d0$`choice-6`[i] %in% categories_low$oldies)
      d0$base_books[i] <- sum(d0$`choice-1`[i] %in% categories_low$books,
                              d0$`choice-2`[i] %in% categories_low$books,
                              d0$`choice-3`[i] %in% categories_low$books,
                              d0$`choice-4`[i] %in% categories_low$books,
                              d0$`choice-5`[i] %in% categories_low$books,
                              d0$`choice-6`[i] %in% categories_low$books)
    }
  }

  # Continue processing demographics
  d0 <- d0 |>
    mutate(
      # Demographics
      gender_code = case_when(gender=="Man" ~ 1, TRUE ~ 0),
      race_code = case_when(str_detect(race, "White / Caucasian") ~ 1, TRUE ~ 0)
    ) |>
    dplyr::select(cond, base_condition, gender_feedback, poets_shown, oldies_shown, books_shown, women_shown,
                  female_pick, poets_pick, oldies_pick, books_pick,
                  base_gender, base_poets, base_oldies, base_books, `choice-1`:`choice-7`,
                  race, gender, age, gender_code, race_code)

  # Calculate the number of excluded participants
  num_excluded <- nrow(qual_data) - nrow(d0)

  # Save num_excluded in d0
  d0$num_excluded_total <- num_excluded  # As a column

  # Write the API-pulled data into a CSV file
  write.csv(d0, 'pilot-study.csv', row.names = FALSE, quote = TRUE)
}
```

\newpage

## Variable Names

\begin{table}[!htbp] \centering
  \label{tab:variables}
\begin{tabular}{|l|p{10cm}|}
\hline
\textbf{Variable} & \textbf{Description} \\
\hline
\texttt{cond} & Treatment condition (control or treat). \\
\hline
\texttt{base\_condition} & Base condition (low = 3 authors, med = 6 authors, high = 9 authors per category). \\
\hline
\texttt{gender\_feedback} & Binary indicator of whether participant was in treatment condition (cond = treat). \\
\hline
\texttt{female\_pick} & Binary indicator of whether participant selected a female author for seventh selection. \\
\hline
\texttt{poets\_pick} & Binary indicator of whether participant selected an author who wrote poetry. \\
\hline
\texttt{oldies\_pick} & Binary indicator of whether participant selected an author born in the 1800s. \\
\hline
\texttt{books\_pick} & Binary indicator of whether participant selected an author who wrote 10+ books. \\
\hline
\texttt{base\_gender} & Count of female authors selected in initial six authors. \\
\hline
\texttt{base\_poets} & Count of poets selected in initial six authors. \\
\hline
\texttt{base\_oldies} & Count of 1800s-born authors selected in initial six authors. \\
\hline
\texttt{base\_books} & Count of 10+ book authors selected in initial six authors. \\
\hline
\texttt{choice-1 to choice-7} & The selected authors. \\
\hline
\texttt{gender} & Self-selected gender. \\
\hline
\texttt{race} & Self-selected race. \\
\hline
\texttt{age} & Self-entered age. \\
\hline
\texttt{gender\_code} & Dummy code for gender (male = 1). \\
\hline
\texttt{race\_code} & Dummy code for race (white = 1). \\
\hline
\end{tabular}
\end{table}

\newpage

## Demographics

```{r results='markup'}
## Excluded participants

cat('Excluded Participants:', num_excluded, '\n')

## Gender

gender_percentages <- round(prop.table(table(d0$gender)) * 100, 2)

gender_df <- data.frame(
  Percentage = gender_percentages,
  gender = names(gender_percentages)
)[1:2]

colnames(gender_df) <- c("Percentage", "gender")

print(gender_df)


## Race


race_percentages <- round(prop.table(table(d0$race)) * 100, 2)

# Create the final data frame
race_df <- data.frame(
  Percentage = race_percentages,
  Race = names(race_percentages)
)[1:2]

# Reorder the columns
colnames(race_df) <- c("Percentage", "Race")

# Print the data frame
print(race_df)

## Age

age_summary <- d0 |>
  dplyr::select(age) |>
  summarize(mean_age = mean(age, na.rm = T), sd_age = sd(age, na.rm = T))

age_summary

## Initial Selections Summary

cat('\n--- Initial Selections (Women) ---\n')
cat('Mean (num of initial women selected): ', round(mean(d0$base_gender), 2), '\n')
cat('SD (num of initial women selected): ',round(sd(d0$base_gender), 2), '\n')
cat('Percentage (initial women selected): ', round(mean(d0$base_gender)/6 * 100, 2), '%\n')

cat('\n--- Balance Checks by Condition ---\n')
d0 |>
  dplyr::select(base_gender, gender_feedback) |>
  dplyr::group_by(gender_feedback) |>
  dplyr::summarize(mean_women = mean(base_gender/6))

t.test(base_gender/6 ~ gender_feedback, data=d0)

# Also check balance by base condition
cat('\n--- Balance by Base Condition ---\n')
d0 |>
  dplyr::group_by(base_condition) |>
  dplyr::summarize(
    n = n(),
    mean_women = mean(base_gender/6),
    mean_poets = mean(base_poets/6),
    mean_oldies = mean(base_oldies/6),
    mean_books = mean(base_books/6)
  )

```

\newpage

## Primary Analysis

### Low Base Condition (3 authors per category)

```{r echo=TRUE, results='markup'}
# Create condition-specific datasets
d0_low <- d0 |> filter(base_condition == "low")
d0_med <- d0 |> filter(base_condition == "med")
d0_high <- d0 |> filter(base_condition == "high")

# Effect of gender feedback in low base condition
r_low <- lm(female_pick ~ gender_feedback, data=d0_low)

cat("Effect in Low Base Condition (3 authors per category):\n")
robust_summary(r_low)
robust_confint(r_low)
```

\newpage

### Medium Base Condition (6 authors per category)

```{r echo=TRUE, results='markup'}
# Effect of gender feedback in medium base condition
r_med <- lm(female_pick ~ gender_feedback, data=d0_med)

cat("Effect in Medium Base Condition (6 authors per category):\n")
robust_summary(r_med)
robust_confint(r_med)
```

\newpage

### High Base Condition (9 authors per category)

```{r echo=TRUE, results='markup'}
# Effect of gender feedback in high base condition
r_high <- lm(female_pick ~ gender_feedback, data=d0_high)

cat("Effect in High Base Condition (9 authors per category):\n")
robust_summary(r_high)
robust_confint(r_high)
```

\newpage

### Interaction Model

```{r echo=TRUE, results='markup'}
# Full 2x3 factorial model testing interaction
# Factor base_condition with reference category
d0$base_condition_factor <- factor(d0$base_condition, levels = c("low", "med", "high"))

r_factorial <- lm(female_pick ~ gender_feedback * base_condition_factor, data=d0)

cat("2x3 Factorial Design: Gender Feedback x Base Condition\n")
robust_summary(r_factorial)
robust_confint(r_factorial)

```

\newpage

### Testing Differences in Effects Across Base Conditions

```{r echo=TRUE, results='markup'}
# Test whether the effect of gender feedback differs significantly
# across the three base conditions

# Extract interaction coefficients
rob_sum <- robust_summary(r_factorial)
rob_ci <- robust_confint(r_factorial)

cat('\nInteraction Effects (relative to Low base):\n\n')

# Medium vs Low
if('gender_feedback:base_condition_factormed' %in% rownames(rob_sum$coefficients)) {
  interaction_coef_med <- rob_sum$coefficients['gender_feedback:base_condition_factormed', 'Estimate']
  interaction_se_med <- rob_sum$coefficients['gender_feedback:base_condition_factormed', 'Std. Error']
  interaction_p_med <- rob_sum$coefficients['gender_feedback:base_condition_factormed', 'Pr(>|t|)']

  cat('Medium vs Low:\n')
  cat('  Difference in effects:', round(interaction_coef_med * 100, 2), 'percentage points\n')
  cat('  Robust standard error:', round(interaction_se_med * 100, 2), '\n')
  cat('  p-value:', round(interaction_p_med, 4), '\n\n')
}

# High vs Low
if('gender_feedback:base_condition_factorhigh' %in% rownames(rob_sum$coefficients)) {
  interaction_coef_high <- rob_sum$coefficients['gender_feedback:base_condition_factorhigh', 'Estimate']
  interaction_se_high <- rob_sum$coefficients['gender_feedback:base_condition_factorhigh', 'Std. Error']
  interaction_p_high <- rob_sum$coefficients['gender_feedback:base_condition_factorhigh', 'Pr(>|t|)']

  cat('High vs Low:\n')
  cat('  Difference in effects:', round(interaction_coef_high * 100, 2), 'percentage points\n')
  cat('  Robust standard error:', round(interaction_se_high * 100, 2), '\n')
  cat('  p-value:', round(interaction_p_high, 4), '\n\n')
}

# Joint F-test for interaction terms
library(car)
cat('\nJoint test of interaction terms:\n')
linearHypothesis(r_factorial, c("gender_feedback:base_condition_factormed = 0",
                                 "gender_feedback:base_condition_factorhigh = 0"),
                 vcov = vcovHC(r_factorial, type = "HC3"))
```

\newpage

### Visualization of 2x3 Design

```{r echo=TRUE}
library(ggplot2)

interaction_means <- d0 |>
  group_by(gender_feedback, base_condition) |>
  summarize(
    mean_female = mean(female_pick, na.rm = TRUE),
    se_female = sd(female_pick, na.rm = TRUE) / sqrt(n()),
    n = n()
  )

p_2x3 <- ggplot(interaction_means, aes(x = factor(base_condition, levels = c("low", "med", "high")),
                                       y = mean_female * 100,
                                       fill = factor(gender_feedback))) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.7) +
  # White text inside bars (when bar is tall enough)
  geom_text(aes(label = ifelse(mean_female * 100 > 15,
                                paste0(sprintf("%.1f", mean_female * 100), "%"), "")),
            position = position_dodge(width = 0.8), vjust = 1.5, size = 7, color = "white") +
  # Black text above bars (when bar is too small for white text)
  geom_text(aes(label = ifelse(mean_female * 100 <= 15,
                                paste0(sprintf("%.1f", mean_female * 100), "%"), "")),
            position = position_dodge(width = 0.8), vjust = -0.5, size = 7, color = "black") +
  geom_errorbar(aes(ymin = (mean_female - 1.96*se_female) * 100,
                    ymax = (mean_female + 1.96*se_female) * 100),
                width = 0.2, position = position_dodge(width = 0.8)) +
  scale_fill_manual(values = c("0" = "#011F5B", "1" = "#990000"),
                    labels = c("0" = "Control", "1" = "Gender Feedback")) +
  scale_y_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 50),
                     breaks = seq(0, 50, 10)) +
  labs(x = "Base Condition (Category Size)",
       y = "% Selecting Female Author",
       title = "Gender Feedback x Base Condition",
       fill = "Treatment") +
  scale_x_discrete(labels = c("low" = "Low\n(3 authors)", "med" = "Medium\n(6 authors)",
                              "high" = "High\n(9 authors)")) +
  theme_bw() +
  theme(legend.position = "top",
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())

print(p_2x3)
ggsave("Figure-Pilot-Overall.pdf", plot = p_2x3, width = 10, height = 8, units = "in", device = cairo_pdf, family = "Times New Roman")
```

\newpage

## Robustness Checks

### Low Base Condition

```{r echo=TRUE, results='markup'}
## Robust to demographic controls
r_low_demog <- lm(female_pick ~ gender_feedback + gender_code + race_code + age, data=d0_low)

cat("Low Base: With Demographic Controls\n")
robust_summary(r_low_demog)
robust_confint(r_low_demog)

## Logistic regression
r_low_logit <- glm(female_pick ~ gender_feedback, family = binomial, data=d0_low)
cat("\nLow Base: Logistic Regression Model\n")
summary(r_low_logit)
# Odds ratio
tidy_low_logit <- tidy(r_low_logit, exponentiate = TRUE, conf.int = T)
print(tidy_low_logit)
```

\newpage

### Medium Base Condition

```{r echo=TRUE, results='markup'}
## Robust to demographic controls
r_med_demog <- lm(female_pick ~ gender_feedback + gender_code + race_code + age, data=d0_med)

cat("Medium Base: With Demographic Controls\n")
robust_summary(r_med_demog)
robust_confint(r_med_demog)

## Logistic regression
r_med_logit <- glm(female_pick ~ gender_feedback, family = binomial, data=d0_med)
cat("\nMedium Base: Logistic Regression Model\n")
summary(r_med_logit)
# Odds ratio
tidy_med_logit <- tidy(r_med_logit, exponentiate = TRUE, conf.int = T)
print(tidy_med_logit)
```

\newpage

### High Base Condition

```{r echo=TRUE, results='markup'}
## Robust to demographic controls
r_high_demog <- lm(female_pick ~ gender_feedback + gender_code + race_code + age, data=d0_high)

cat("High Base: With Demographic Controls\n")
robust_summary(r_high_demog)
robust_confint(r_high_demog)

## Logistic regression
r_high_logit <- glm(female_pick ~ gender_feedback, family = binomial, data=d0_high)
cat("\nHigh Base: Logistic Regression Model\n")
summary(r_high_logit)
# Odds ratio
tidy_high_logit <- tidy(r_high_logit, exponentiate = TRUE, conf.int = T)
print(tidy_high_logit)
```

\newpage

### Interaction Model with Controls

```{r echo=TRUE, results='markup'}
## Interaction model with demographic controls
r_factorial_demog <- lm(female_pick ~ gender_feedback*base_condition_factor + gender_code + race_code + age, data=d0)

cat("2x3 Factorial with Demographic Controls\n")
robust_summary(r_factorial_demog)
robust_confint(r_factorial_demog)

## Logistic regression with interaction
r_factorial_logit <- glm(female_pick ~ gender_feedback*base_condition_factor, family = binomial, data=d0)
cat("\n2x3 Factorial: Logistic Regression Model\n")
summary(r_factorial_logit)
# Odds ratio
tidy_factorial_logit <- tidy(r_factorial_logit, exponentiate = TRUE, conf.int = T)
print(tidy_factorial_logit)
```

\newpage

## Interaction with Initial Base Selection

### Low Base Condition

```{r echo=TRUE, results='markup'}
## Interaction with initial women selection in low base
r_interaction_low <- lm(female_pick ~ gender_feedback*base_gender, data=d0_low)

cat("Low Base: Interaction with Initial Women Selection\n")
robust_summary(r_interaction_low)
robust_confint(r_interaction_low)
```

\newpage

### Medium Base Condition

```{r echo=TRUE, results='markup'}
## Interaction with initial women selection in medium base
r_interaction_med <- lm(female_pick ~ gender_feedback*base_gender, data=d0_med)

cat("Medium Base: Interaction with Initial Women Selection\n")
robust_summary(r_interaction_med)
robust_confint(r_interaction_med)
```

\newpage

### High Base Condition

```{r echo=TRUE, results='markup'}
## Interaction with initial women selection in high base
r_interaction_high <- lm(female_pick ~ gender_feedback*base_gender, data=d0_high)

cat("High Base: Interaction with Initial Women Selection\n")
robust_summary(r_interaction_high)
robust_confint(r_interaction_high)
```

\newpage

### Full Model with Three-Way Interaction

```{r echo=TRUE, results='markup'}
## Three-way interaction: gender_feedback x base_condition x base_gender
r_interaction_full <- lm(female_pick ~ gender_feedback*base_condition_factor*base_gender, data=d0)

cat("Three-Way Interaction: Gender Feedback x Base Condition x Initial Women Selection\n")
robust_summary(r_interaction_full)
robust_confint(r_interaction_full)
```

\newpage

## Secondary Analysis - Other Attributes

### Low Base Condition

```{r echo=TRUE, results='markup'}
## Poets feedback - Low Base
r_poets_low <- lm(poets_pick ~ poets_shown, data=d0_low)
cat("Low Base: Effect of Poets Feedback on Poet Selection\n")
robust_summary(r_poets_low)
robust_confint(r_poets_low)

## Oldies (1800s) feedback - Low Base
r_oldies_low <- lm(oldies_pick ~ oldies_shown, data=d0_low)
cat("\nLow Base: Effect of 1800s Feedback on 1800s Author Selection\n")
robust_summary(r_oldies_low)
robust_confint(r_oldies_low)

## Books (10+) feedback - Low Base
r_books_low <- lm(books_pick ~ books_shown, data=d0_low)
cat("\nLow Base: Effect of 10+ Books Feedback on 10+ Books Author Selection\n")
robust_summary(r_books_low)
robust_confint(r_books_low)
```

\newpage

### Medium Base Condition

```{r echo=TRUE, results='markup'}
## Poets feedback - Medium Base
r_poets_med <- lm(poets_pick ~ poets_shown, data=d0_med)
cat("Medium Base: Effect of Poets Feedback on Poet Selection\n")
robust_summary(r_poets_med)
robust_confint(r_poets_med)

## Oldies (1800s) feedback - Medium Base
r_oldies_med <- lm(oldies_pick ~ oldies_shown, data=d0_med)
cat("\nMedium Base: Effect of 1800s Feedback on 1800s Author Selection\n")
robust_summary(r_oldies_med)
robust_confint(r_oldies_med)

## Books (10+) feedback - Medium Base
r_books_med <- lm(books_pick ~ books_shown, data=d0_med)
cat("\nMedium Base: Effect of 10+ Books Feedback on 10+ Books Author Selection\n")
robust_summary(r_books_med)
robust_confint(r_books_med)
```

\newpage

### High Base Condition

```{r echo=TRUE, results='markup'}
## Poets feedback - High Base
r_poets_high <- lm(poets_pick ~ poets_shown, data=d0_high)
cat("High Base: Effect of Poets Feedback on Poet Selection\n")
robust_summary(r_poets_high)
robust_confint(r_poets_high)

## Oldies (1800s) feedback - High Base
r_oldies_high <- lm(oldies_pick ~ oldies_shown, data=d0_high)
cat("\nHigh Base: Effect of 1800s Feedback on 1800s Author Selection\n")
robust_summary(r_oldies_high)
robust_confint(r_oldies_high)

## Books (10+) feedback - High Base
r_books_high <- lm(books_pick ~ books_shown, data=d0_high)
cat("\nHigh Base: Effect of 10+ Books Feedback on 10+ Books Author Selection\n")
robust_summary(r_books_high)
robust_confint(r_books_high)
```

\newpage

### Interaction Models for Other Attributes

```{r echo=TRUE, results='markup'}
## Test if attribute feedback effects differ by base condition
r_poets_interaction <- lm(poets_pick ~ poets_shown*base_condition_factor, data=d0)
cat("Poets x Base Condition Interaction\n")
robust_summary(r_poets_interaction)
robust_confint(r_poets_interaction)

r_oldies_interaction <- lm(oldies_pick ~ oldies_shown*base_condition_factor, data=d0)
cat("\nOldies x Base Condition Interaction\n")
robust_summary(r_oldies_interaction)
robust_confint(r_oldies_interaction)

r_books_interaction <- lm(books_pick ~ books_shown*base_condition_factor, data=d0)
cat("\nBooks x Base Condition Interaction\n")
robust_summary(r_books_interaction)
robust_confint(r_books_interaction)
```

```{r include=FALSE}
# Extract estimates for simple effects within each base condition
# For low base condition
gender_est_low <- extract_regression_estimates(r_low)
poets_est_low <- extract_regression_estimates(r_poets_low)
oldies_est_low <- extract_regression_estimates(r_oldies_low)
books_est_low <- extract_regression_estimates(r_books_low)

# For medium base condition
gender_est_med <- extract_regression_estimates(r_med)
poets_est_med <- extract_regression_estimates(r_poets_med)
oldies_est_med <- extract_regression_estimates(r_oldies_med)
books_est_med <- extract_regression_estimates(r_books_med)

# For high base condition
gender_est_high <- extract_regression_estimates(r_high)
poets_est_high <- extract_regression_estimates(r_poets_high)
oldies_est_high <- extract_regression_estimates(r_oldies_high)
books_est_high <- extract_regression_estimates(r_books_high)

# Create separate data frames for each condition
pilot_estimates_low <- data.frame(
    Study = "PILOT_LOW",
    Base_Condition = "Low (3 authors)",
    Stimuli = c("gender", "poets", "oldies", "books"),
    Estimate = c(gender_est_low$estimate, poets_est_low$estimate, oldies_est_low$estimate, books_est_low$estimate),
    SE = c(gender_est_low$se, poets_est_low$se, oldies_est_low$se, books_est_low$se),
    CI_Lower = c(gender_est_low$ci_lower, poets_est_low$ci_lower, oldies_est_low$ci_lower, books_est_low$ci_lower),
    CI_Upper = c(gender_est_low$ci_upper, poets_est_low$ci_upper, oldies_est_low$ci_upper, books_est_low$ci_upper)
)

pilot_estimates_med <- data.frame(
    Study = "PILOT_MED",
    Base_Condition = "Medium (6 authors)",
    Stimuli = c("gender", "poets", "oldies", "books"),
    Estimate = c(gender_est_med$estimate, poets_est_med$estimate, oldies_est_med$estimate, books_est_med$estimate),
    SE = c(gender_est_med$se, poets_est_med$se, oldies_est_med$se, books_est_med$se),
    CI_Lower = c(gender_est_med$ci_lower, poets_est_med$ci_lower, oldies_est_med$ci_lower, books_est_med$ci_lower),
    CI_Upper = c(gender_est_med$ci_upper, poets_est_med$ci_upper, oldies_est_med$ci_upper, books_est_med$ci_upper)
)

pilot_estimates_high <- data.frame(
    Study = "PILOT_HIGH",
    Base_Condition = "High (9 authors)",
    Stimuli = c("gender", "poets", "oldies", "books"),
    Estimate = c(gender_est_high$estimate, poets_est_high$estimate, oldies_est_high$estimate, books_est_high$estimate),
    SE = c(gender_est_high$se, poets_est_high$se, oldies_est_high$se, books_est_high$se),
    CI_Lower = c(gender_est_high$ci_lower, poets_est_high$ci_lower, oldies_est_high$ci_lower, books_est_high$ci_lower),
    CI_Upper = c(gender_est_high$ci_upper, poets_est_high$ci_upper, oldies_est_high$ci_upper, books_est_high$ci_upper)
)

# Combine all three
pilot_estimates <- rbind(pilot_estimates_low, pilot_estimates_med, pilot_estimates_high)

# Save the estimates to an RDS file
saveRDS(pilot_estimates, file = "pilot_estimates.rds")

```

\newpage

## Deep Dive: Base Rates and Selection Patterns

### Actual Female Selection Rates in First 6 Choices

```{r echo=TRUE, results='markup'}
cat("=== ACTUAL FEMALE SELECTION RATES IN FIRST 6 CHOICES ===\n\n")

# Overall summary
cat("Overall Statistics:\n")
cat("Mean number of women selected (out of 6):", round(mean(d0$base_gender), 2), "\n")
cat("Mean percentage of women selected:", round(mean(d0$base_gender)/6 * 100, 2), "%\n")
cat("SD:", round(sd(d0$base_gender), 2), "\n\n")

# By base condition
cat("By Base Condition:\n")
base_rates_summary <- d0 |>
  group_by(base_condition) |>
  summarise(
    n = n(),
    mean_count = round(mean(base_gender), 2),
    mean_pct = round(mean(base_gender)/6 * 100, 2),
    sd_count = round(sd(base_gender), 2),
    median_count = median(base_gender),
    min_count = min(base_gender),
    max_count = max(base_gender)
  )

print(base_rates_summary)

# Check if high base leads to > 50% women
cat("\n--- Checking if High Base leads to >50% women selected ---\n")
d0_high_summary <- d0 |>
  filter(base_condition == "high") |>
  summarise(
    pct_with_majority_women = round(mean(base_gender > 3) * 100, 2),
    pct_with_half_or_more = round(mean(base_gender >= 3) * 100, 2)
  )

cat("In HIGH base condition:\n")
cat("  % with >50% women (4+ out of 6):", d0_high_summary$pct_with_majority_women, "%\n")
cat("  % with 50% or more women (3+ out of 6):", d0_high_summary$pct_with_half_or_more, "%\n")

# Distribution of base_gender by base_condition
cat("\n--- Distribution of women selected in first 6 choices ---\n")
distribution <- d0 |>
  group_by(base_condition, base_gender) |>
  summarise(n = n(), .groups = "drop") |>
  group_by(base_condition) |>
  mutate(pct = round(n/sum(n) * 100, 1)) |>
  arrange(base_condition, base_gender)

print(distribution)
```

\newpage

### What Feedback is Being Shown

```{r echo=TRUE, results='markup'}
cat("=== FEEDBACK SHOWN TO PARTICIPANTS ===\n\n")

# Who gets what feedback
cat("Feedback Distribution:\n")
feedback_summary <- d0 |>
  summarise(
    n_gender_feedback = sum(gender_feedback),
    n_poets_shown = sum(poets_shown),
    n_oldies_shown = sum(oldies_shown),
    n_books_shown = sum(books_shown),
    pct_gender = round(mean(gender_feedback) * 100, 1),
    pct_poets = round(mean(poets_shown) * 100, 1),
    pct_oldies = round(mean(oldies_shown) * 100, 1),
    pct_books = round(mean(books_shown) * 100, 1)
  )

cat("Gender feedback (treatment):", feedback_summary$n_gender_feedback,
    "(", feedback_summary$pct_gender, "%)\n")
cat("Poets feedback shown:", feedback_summary$n_poets_shown,
    "(", feedback_summary$pct_poets, "%)\n")
cat("Oldies feedback shown:", feedback_summary$n_oldies_shown,
    "(", feedback_summary$pct_oldies, "%)\n")
cat("Books feedback shown:", feedback_summary$n_books_shown,
    "(", feedback_summary$pct_books, "%)\n\n")

# By base condition
cat("Feedback by Base Condition:\n")
feedback_by_base <- d0 |>
  group_by(base_condition) |>
  summarise(
    n = n(),
    pct_gender = round(mean(gender_feedback) * 100, 1),
    pct_poets = round(mean(poets_shown) * 100, 1),
    pct_oldies = round(mean(oldies_shown) * 100, 1),
    pct_books = round(mean(books_shown) * 100, 1)
  )

print(feedback_by_base)

# Crosstab: who gets gender feedback AND which other attribute feedback
cat("\n--- Among those with Gender Feedback, which other attribute? ---\n")
gender_and_other <- d0 |>
  filter(gender_feedback == 1) |>
  summarise(
    n = n(),
    n_poets = sum(poets_shown),
    n_oldies = sum(oldies_shown),
    n_books = sum(books_shown),
    pct_poets = round(mean(poets_shown) * 100, 1),
    pct_oldies = round(mean(oldies_shown) * 100, 1),
    pct_books = round(mean(books_shown) * 100, 1)
  )

print(gender_and_other)
```

\newpage

### Comparative Selection Rates Across All Attributes

```{r echo=TRUE, results='markup'}
cat("=== BASE RATES OF ALL FOUR ATTRIBUTES IN FIRST 6 SELECTIONS ===\n\n")

# Overall across all conditions
cat("Overall Statistics (all base conditions combined):\n")
overall_attrs <- d0 |>
  summarise(
    mean_women = round(mean(base_gender), 2),
    mean_poets = round(mean(base_poets), 2),
    mean_oldies = round(mean(base_oldies), 2),
    mean_books = round(mean(base_books), 2),
    pct_women = round(mean(base_gender)/6 * 100, 1),
    pct_poets = round(mean(base_poets)/6 * 100, 1),
    pct_oldies = round(mean(base_oldies)/6 * 100, 1),
    pct_books = round(mean(base_books)/6 * 100, 1)
  )

print(overall_attrs)

cat("\n--- By Base Condition ---\n")
by_base <- d0 |>
  group_by(base_condition) |>
  summarise(
    n = n(),
    women_pct = round(mean(base_gender)/6 * 100, 1),
    poets_pct = round(mean(base_poets)/6 * 100, 1),
    oldies_pct = round(mean(base_oldies)/6 * 100, 1),
    books_pct = round(mean(base_books)/6 * 100, 1)
  )

print(by_base)

cat("\n--- 7th Selection Rates by Attribute and Base Condition ---\n")
seventh_selection <- d0 |>
  group_by(base_condition) |>
  summarise(
    n = n(),
    pct_select_woman = round(mean(female_pick) * 100, 1),
    pct_select_poet = round(mean(poets_pick) * 100, 1),
    pct_select_oldies = round(mean(oldies_pick) * 100, 1),
    pct_select_books = round(mean(books_pick) * 100, 1)
  )

print(seventh_selection)
```

\newpage

### Which Attribute Wins When Multiple are Underrepresented?

```{r echo=TRUE, results='markup'}
cat("=== ATTRIBUTE PRIORITIZATION ANALYSIS ===\n\n")
cat("When multiple attributes are underrepresented, which gets selected for 7th pick?\n\n")

# Create underrepresentation indicators (below 50%)
d0 <- d0 |>
  mutate(
    women_underrep = as.numeric(base_gender < 3),
    poets_underrep = as.numeric(base_poets < 3),
    oldies_underrep = as.numeric(base_oldies < 3),
    books_underrep = as.numeric(base_books < 3),
    num_underrep = women_underrep + poets_underrep + oldies_underrep + books_underrep
  )

# Summary of underrepresentation
cat("Distribution of number of underrepresented attributes:\n")
underrep_dist <- d0 |>
  group_by(num_underrep) |>
  summarise(n = n(), pct = round(n/nrow(d0) * 100, 1))

print(underrep_dist)

# When women are underrepresented vs not
cat("\n--- 7th Selection when Women ARE underrepresented (<50%) ---\n")
when_women_underrep <- d0 |>
  filter(women_underrep == 1) |>
  summarise(
    n = n(),
    pct_select_woman = round(mean(female_pick) * 100, 1),
    pct_select_poet = round(mean(poets_pick) * 100, 1),
    pct_select_oldies = round(mean(oldies_pick) * 100, 1),
    pct_select_books = round(mean(books_pick) * 100, 1)
  )

print(when_women_underrep)

cat("\n--- 7th Selection when Women are NOT underrepresented (>=50%) ---\n")
when_women_not_underrep <- d0 |>
  filter(women_underrep == 0) |>
  summarise(
    n = n(),
    pct_select_woman = round(mean(female_pick) * 100, 1),
    pct_select_poet = round(mean(poets_pick) * 100, 1),
    pct_select_oldies = round(mean(oldies_pick) * 100, 1),
    pct_select_books = round(mean(books_pick) * 100, 1)
  )

print(when_women_not_underrep)

# Most underrepresented attribute analysis
cat("\n--- Which attribute is MOST underrepresented? ---\n")
d0 <- d0 |>
  mutate(
    most_underrep = case_when(
      base_gender < pmin(base_poets, base_oldies, base_books) ~ "women",
      base_poets < pmin(base_gender, base_oldies, base_books) ~ "poets",
      base_oldies < pmin(base_gender, base_poets, base_books) ~ "oldies",
      base_books < pmin(base_gender, base_poets, base_oldies) ~ "books",
      TRUE ~ "tie"
    )
  )

most_underrep_dist <- d0 |>
  group_by(most_underrep) |>
  summarise(n = n(), pct = round(n/nrow(d0) * 100, 1))

cat("Distribution of which attribute is most underrepresented:\n")
print(most_underrep_dist)

# When each attribute is most underrepresented, what gets selected?
cat("\n--- When WOMEN are most underrepresented, 7th selection: ---\n")
d0 |> filter(most_underrep == "women") |>
  summarise(
    n = n(),
    pct_woman = round(mean(female_pick) * 100, 1),
    pct_poet = round(mean(poets_pick) * 100, 1),
    pct_oldies = round(mean(oldies_pick) * 100, 1),
    pct_books = round(mean(books_pick) * 100, 1)
  ) |> print()

cat("\n--- When POETS are most underrepresented, 7th selection: ---\n")
d0 |> filter(most_underrep == "poets") |>
  summarise(
    n = n(),
    pct_woman = round(mean(female_pick) * 100, 1),
    pct_poet = round(mean(poets_pick) * 100, 1),
    pct_oldies = round(mean(oldies_pick) * 100, 1),
    pct_books = round(mean(books_pick) * 100, 1)
  ) |> print()

cat("\n--- When OLDIES are most underrepresented, 7th selection: ---\n")
d0 |> filter(most_underrep == "oldies") |>
  summarise(
    n = n(),
    pct_woman = round(mean(female_pick) * 100, 1),
    pct_poet = round(mean(poets_pick) * 100, 1),
    pct_oldies = round(mean(oldies_pick) * 100, 1),
    pct_books = round(mean(books_pick) * 100, 1)
  ) |> print()

cat("\n--- When BOOKS are most underrepresented, 7th selection: ---\n")
d0 |> filter(most_underrep == "books") |>
  summarise(
    n = n(),
    pct_woman = round(mean(female_pick) * 100, 1),
    pct_poet = round(mean(poets_pick) * 100, 1),
    pct_oldies = round(mean(oldies_pick) * 100, 1),
    pct_books = round(mean(books_pick) * 100, 1)
  ) |> print()
```

\newpage

### Treatment Effect by Level of Underrepresentation

```{r echo=TRUE, results='markup'}
cat("=== TREATMENT EFFECT CONDITIONAL ON UNDERREPRESENTATION ===\n\n")

# Among those who received GENDER feedback
cat("--- Among those who received GENDER feedback ---\n\n")

cat("When women ARE underrepresented (<50%):\n")
r_gender_underrep <- d0 |>
  filter(women_underrep == 1) |>
  lm(female_pick ~ gender_feedback, data = _)

robust_summary(r_gender_underrep)

cat("\nWhen women are NOT underrepresented (>=50%):\n")
r_gender_not_underrep <- d0 |>
  filter(women_underrep == 0) |>
  lm(female_pick ~ gender_feedback, data = _)

robust_summary(r_gender_not_underrep)

# Compare means
cat("\n--- Mean selection rates ---\n")
d0 |>
  group_by(women_underrep, gender_feedback) |>
  summarise(
    n = n(),
    pct_select_woman = round(mean(female_pick) * 100, 1)
  ) |>
  print()

# Interaction model
cat("\n--- Interaction: Gender Feedback x Women Underrepresented ---\n")
r_interaction_underrep <- lm(female_pick ~ gender_feedback * women_underrep, data = d0)
robust_summary(r_interaction_underrep)
robust_confint(r_interaction_underrep)
```


## Figure - Simple Effects by Base Condition

### Low Base Condition Figure (3 authors)

```{r echo=TRUE}

# Get p-values from regression models for LOW base condition
p_gender_low <- robust_summary(r_low)$coefficients["gender_feedback", "Pr(>|t|)"]
p_poets_low <- robust_summary(r_poets_low)$coefficients["poets_shown", "Pr(>|t|)"]
p_oldies_low <- robust_summary(r_oldies_low)$coefficients["oldies_shown", "Pr(>|t|)"]
p_books_low <- robust_summary(r_books_low)$coefficients["books_shown", "Pr(>|t|)"]

# Function to convert p-value to significance stars
get_sig_stars <- function(p) {
  if (p < 0.001) return("***")
  else if (p < 0.01) return("**")
  else if (p < 0.05) return("*")
  else return("n.s.")
}

# Get significance labels for LOW base
sig_gender_low <- get_sig_stars(p_gender_low)
sig_poets_low <- get_sig_stars(p_poets_low)
sig_oldies_low <- get_sig_stars(p_oldies_low)
sig_books_low <- get_sig_stars(p_books_low)

dfemale_plot_low <- d0_low |>
  dplyr::select(gender_feedback, female_pick) |>
  dplyr::group_by(gender_feedback) |>
  dplyr::summarise(
    n = n(),
    freq = mean(female_pick),
    sd = sd(female_pick) * 100,
    se = (sd(female_pick) / sqrt(n())) * 100
  ) |>
  dplyr::mutate(
    gender_feedback = case_when(
      gender_feedback == 1 ~ "\"Treatment\"",
      TRUE ~ "\"Control\""
    )
  ) |>
  dplyr::rename(Condition = gender_feedback)

dpoets_plot_low <- d0_low |>
  dplyr::select(poets_shown, poets_pick) |>
  dplyr::group_by(poets_shown) |>
  dplyr::summarise(
    n = n(),
    freq = mean(poets_pick),
    sd = sd(poets_pick) * 100,
    se = (sd(poets_pick) / sqrt(n())) * 100
  )|>
  mutate(poets_shown = case_when(poets_shown==1 ~ "\"Treatment\"",
                          TRUE ~ "\"Control\"")) |>
  rename(Condition = poets_shown)

doldies_plot_low <- d0_low |>
  dplyr::select(oldies_shown, oldies_pick) |>
  dplyr::group_by(oldies_shown) |>
  dplyr::summarise(
    n = n(),
    freq = mean(oldies_pick),
    sd = sd(oldies_pick) * 100,
    se = (sd(oldies_pick) / sqrt(n())) * 100
  )|>
  mutate(oldies_shown = case_when(oldies_shown==1 ~ "\"Treatment\"",
                          TRUE ~ "\"Control\"")) |>
  rename(Condition = oldies_shown)

dbooks_plot_low <- d0_low |>
  dplyr::select(books_shown, books_pick) |>
  dplyr::group_by(books_shown) |>
  dplyr::summarise(
    n = n(),
    freq = mean(books_pick),
    sd = sd(books_pick) * 100,
    se = (sd(books_pick) / sqrt(n())) * 100
  )|>
  mutate(books_shown = case_when(books_shown==1 ~ "\"Treatment\"",
                          TRUE ~ "\"Control\"")) |>
  rename(Condition = books_shown)

## Combine plots for LOW base
df_combined_low <- bind_rows(
  dpoets_plot_low %>% mutate(Category = "\nWrote Poetry", sig_label = sig_poets_low),
  doldies_plot_low %>% mutate(Category = "\nBorn in 1800s", sig_label = sig_oldies_low),
  dbooks_plot_low %>% mutate(Category = "\n10+ Books\nWritten", sig_label = sig_books_low),
  dfemale_plot_low %>% mutate(Category = "\nWere Women", sig_label = sig_gender_low)
, .id = "id") %>%
  mutate(Category = factor(Category, levels = c('\nWrote Poetry', '\nBorn in 1800s', '\n10+ Books\nWritten', '\nWere Women')))

p_combined_low <- ggplot(df_combined_low, aes(x = Condition, y = freq*100, fill = Condition)) +
  geom_bar(stat="identity", width = 0.85, position = position_dodge(width = 0.7)) +
  geom_text(aes(label=paste0(sprintf("%.1f", freq*100),"%")),
            position=position_dodge(width=0.7), vjust=5, size = 5, color = "white") +
  geom_errorbar(aes(ymin=freq*100-se, ymax=freq*100+se), width = .1, position = position_dodge(width = 0.7)) +
  facet_wrap(~factor(Category, c('\nWrote Poetry', '\nBorn in 1800s', '\n10+ Books\nWritten', '\nWere Women')), nrow = 1, strip.position = "bottom") +
   geom_segment(data = df_combined_low %>% filter(Condition == "\"Treatment\""),
                aes(x = 1, xend = 2, y = freq*100 + se + 5, yend = freq*100 + se + 5),
                inherit.aes = FALSE) +
   geom_text(data = df_combined_low %>% filter(Condition == "\"Treatment\""),
             aes(x = 1.5, y = freq*100 + se + 7, label = sig_label),
             inherit.aes = FALSE, vjust = 0, size = 5) +
  theme_bw() +
  scale_fill_manual(values = c("#990000", "#011F5B"), labels = c("No feedback provided", "Feedback provided"), "Feedback") +
  scale_y_continuous(labels = function(x) paste0(x,"%"), limits = c(0,100)) +
  scale_x_discrete(labels = c("\"Control\"" = "Not\nShown", "\"Treatment\"" = "Shown")) +
  labs(x = "Feedback on % of authors who...", y = "% of New Authors with the Target Attribute",
       title = "Low Base Condition (3 authors per category)") +
  theme(plot.caption = element_text(face = "italic"),
        legend.position = c(0.5, 0.95),
        legend.title = element_blank(),
        legend.direction = "horizontal",
        legend.text = element_text(size = 20),
        legend.key.size = unit(7, 'mm'),
        legend.background = element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid = element_blank(),
        panel.border = element_rect(fill= NA, color = "white"),
        plot.background = element_rect(fill = "white"),
        panel.background = element_rect(fill = "white"),
        axis.title.x = element_text(face="bold", size = 21, vjust = 17),
        plot.title = element_text(size = 18, hjust = 0.5),
        axis.title.y = element_text(size = 20, color = "black"),
        axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_text(size = 20, color = "black"),
        strip.text = element_text(size = 20, color = "black"),
        strip.background = element_rect(colour = "white", fill = "white"))

print(p_combined_low)
ggsave("Figure-Pilot-Low.pdf", plot = p_combined_low, width = 10, height = 8, units = "in", device = cairo_pdf, family = "Times New Roman")
```

\newpage

### Medium Base Condition Figure (6 authors)

```{r echo=TRUE}
# Get p-values from regression models for MEDIUM base condition
p_gender_med <- robust_summary(r_med)$coefficients["gender_feedback", "Pr(>|t|)"]
p_poets_med <- robust_summary(r_poets_med)$coefficients["poets_shown", "Pr(>|t|)"]
p_oldies_med <- robust_summary(r_oldies_med)$coefficients["oldies_shown", "Pr(>|t|)"]
p_books_med <- robust_summary(r_books_med)$coefficients["books_shown", "Pr(>|t|)"]

# Get significance labels for MEDIUM base
sig_gender_med <- get_sig_stars(p_gender_med)
sig_poets_med <- get_sig_stars(p_poets_med)
sig_oldies_med <- get_sig_stars(p_oldies_med)
sig_books_med <- get_sig_stars(p_books_med)

dfemale_plot_med <- d0_med |>
  dplyr::select(gender_feedback, female_pick) |>
  dplyr::group_by(gender_feedback) |>
  dplyr::summarise(
    n = n(),
    freq = mean(female_pick),
    sd = sd(female_pick) * 100,
    se = (sd(female_pick) / sqrt(n())) * 100
  ) |>
  dplyr::mutate(
    gender_feedback = case_when(
      gender_feedback == 1 ~ "\"Treatment\"",
      TRUE ~ "\"Control\""
    )
  ) |>
  dplyr::rename(Condition = gender_feedback)

dpoets_plot_med <- d0_med |>
  dplyr::select(poets_shown, poets_pick) |>
  dplyr::group_by(poets_shown) |>
  dplyr::summarise(
    n = n(),
    freq = mean(poets_pick),
    sd = sd(poets_pick) * 100,
    se = (sd(poets_pick) / sqrt(n())) * 100
  )|>
  mutate(poets_shown = case_when(poets_shown==1 ~ "\"Treatment\"",
                          TRUE ~ "\"Control\"")) |>
  rename(Condition = poets_shown)

doldies_plot_med <- d0_med |>
  dplyr::select(oldies_shown, oldies_pick) |>
  dplyr::group_by(oldies_shown) |>
  dplyr::summarise(
    n = n(),
    freq = mean(oldies_pick),
    sd = sd(oldies_pick) * 100,
    se = (sd(oldies_pick) / sqrt(n())) * 100
  )|>
  mutate(oldies_shown = case_when(oldies_shown==1 ~ "\"Treatment\"",
                          TRUE ~ "\"Control\"")) |>
  rename(Condition = oldies_shown)

dbooks_plot_med <- d0_med |>
  dplyr::select(books_shown, books_pick) |>
  dplyr::group_by(books_shown) |>
  dplyr::summarise(
    n = n(),
    freq = mean(books_pick),
    sd = sd(books_pick) * 100,
    se = (sd(books_pick) / sqrt(n())) * 100
  )|>
  mutate(books_shown = case_when(books_shown==1 ~ "\"Treatment\"",
                          TRUE ~ "\"Control\"")) |>
  rename(Condition = books_shown)

## Combine plots for MEDIUM base
df_combined_med <- bind_rows(
  dpoets_plot_med %>% mutate(Category = "\nWrote Poetry", sig_label = sig_poets_med),
  doldies_plot_med %>% mutate(Category = "\nBorn in 1800s", sig_label = sig_oldies_med),
  dbooks_plot_med %>% mutate(Category = "\n10+ Books\nWritten", sig_label = sig_books_med),
  dfemale_plot_med %>% mutate(Category = "\nWere Women", sig_label = sig_gender_med)
, .id = "id") %>%
  mutate(Category = factor(Category, levels = c('\nWrote Poetry', '\nBorn in 1800s', '\n10+ Books\nWritten', '\nWere Women')))

p_combined_med <- ggplot(df_combined_med, aes(x = Condition, y = freq*100, fill = Condition)) +
  geom_bar(stat="identity", width = 0.85, position = position_dodge(width = 0.7)) +
  geom_text(aes(label=paste0(sprintf("%.1f", freq*100),"%")),
            position=position_dodge(width=0.7), vjust=5, size = 5, color = "white") +
  geom_errorbar(aes(ymin=freq*100-se, ymax=freq*100+se), width = .1, position = position_dodge(width = 0.7)) +
  facet_wrap(~factor(Category, c('\nWrote Poetry', '\nBorn in 1800s', '\n10+ Books\nWritten', '\nWere Women')), nrow = 1, strip.position = "bottom") +
   geom_segment(data = df_combined_med %>% filter(Condition == "\"Treatment\""),
                aes(x = 1, xend = 2, y = freq*100 + se + 5, yend = freq*100 + se + 5),
                inherit.aes = FALSE) +
   geom_text(data = df_combined_med %>% filter(Condition == "\"Treatment\""),
             aes(x = 1.5, y = freq*100 + se + 7, label = sig_label),
             inherit.aes = FALSE, vjust = 0, size = 5) +
  theme_bw() +
  scale_fill_manual(values = c("#990000", "#011F5B"), labels = c("No feedback provided", "Feedback provided"), "Feedback") +
  scale_y_continuous(labels = function(x) paste0(x,"%"), limits = c(0,100)) +
  scale_x_discrete(labels = c("\"Control\"" = "Not\nShown", "\"Treatment\"" = "Shown")) +
  labs(x = "Feedback on % of authors who...", y = "% of New Authors with the Target Attribute",
       title = "Medium Base Condition (6 authors per category)") +
  theme(plot.caption = element_text(face = "italic"),
        legend.position = c(0.5, 0.95),
        legend.title = element_blank(),
        legend.direction = "horizontal",
        legend.text = element_text(size = 20),
        legend.key.size = unit(7, 'mm'),
        legend.background = element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid = element_blank(),
        panel.border = element_rect(fill= NA, color = "white"),
        plot.background = element_rect(fill = "white"),
        panel.background = element_rect(fill = "white"),
        axis.title.x = element_text(face="bold", size = 21, vjust = 17),
        plot.title = element_text(size = 18, hjust = 0.5),
        axis.title.y = element_text(size = 20, color = "black"),
        axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_text(size = 20, color = "black"),
        strip.text = element_text(size = 20, color = "black"),
        strip.background = element_rect(colour = "white", fill = "white"))

print(p_combined_med)
ggsave("Figure-Pilot-Med.pdf", plot = p_combined_med, width = 10, height = 8, units = "in", device = cairo_pdf, family = "Times New Roman")
```

\newpage

### High Base Condition Figure (9 authors)

```{r echo=TRUE}
# Get p-values from regression models for HIGH base condition
p_gender_high <- robust_summary(r_high)$coefficients["gender_feedback", "Pr(>|t|)"]
p_poets_high <- robust_summary(r_poets_high)$coefficients["poets_shown", "Pr(>|t|)"]
p_oldies_high <- robust_summary(r_oldies_high)$coefficients["oldies_shown", "Pr(>|t|)"]
p_books_high <- robust_summary(r_books_high)$coefficients["books_shown", "Pr(>|t|)"]

# Get significance labels for HIGH base
sig_gender_high <- get_sig_stars(p_gender_high)
sig_poets_high <- get_sig_stars(p_poets_high)
sig_oldies_high <- get_sig_stars(p_oldies_high)
sig_books_high <- get_sig_stars(p_books_high)

dfemale_plot_high <- d0_high |>
  dplyr::select(gender_feedback, female_pick) |>
  dplyr::group_by(gender_feedback) |>
  dplyr::summarise(
    n = n(),
    freq = mean(female_pick),
    sd = sd(female_pick) * 100,
    se = (sd(female_pick) / sqrt(n())) * 100
  ) |>
  dplyr::mutate(
    gender_feedback = case_when(
      gender_feedback == 1 ~ "\"Treatment\"",
      TRUE ~ "\"Control\""
    )
  ) |>
  dplyr::rename(Condition = gender_feedback)

dpoets_plot_high <- d0_high |>
  dplyr::select(poets_shown, poets_pick) |>
  dplyr::group_by(poets_shown) |>
  dplyr::summarise(
    n = n(),
    freq = mean(poets_pick),
    sd = sd(poets_pick) * 100,
    se = (sd(poets_pick) / sqrt(n())) * 100
  )|>
  mutate(poets_shown = case_when(poets_shown==1 ~ "\"Treatment\"",
                          TRUE ~ "\"Control\"")) |>
  rename(Condition = poets_shown)

doldies_plot_high <- d0_high |>
  dplyr::select(oldies_shown, oldies_pick) |>
  dplyr::group_by(oldies_shown) |>
  dplyr::summarise(
    n = n(),
    freq = mean(oldies_pick),
    sd = sd(oldies_pick) * 100,
    se = (sd(oldies_pick) / sqrt(n())) * 100
  )|>
  mutate(oldies_shown = case_when(oldies_shown==1 ~ "\"Treatment\"",
                          TRUE ~ "\"Control\"")) |>
  rename(Condition = oldies_shown)

dbooks_plot_high <- d0_high |>
  dplyr::select(books_shown, books_pick) |>
  dplyr::group_by(books_shown) |>
  dplyr::summarise(
    n = n(),
    freq = mean(books_pick),
    sd = sd(books_pick) * 100,
    se = (sd(books_pick) / sqrt(n())) * 100
  )|>
  mutate(books_shown = case_when(books_shown==1 ~ "\"Treatment\"",
                          TRUE ~ "\"Control\"")) |>
  rename(Condition = books_shown)

## Combine plots for HIGH base
df_combined_high <- bind_rows(
  dpoets_plot_high %>% mutate(Category = "\nWrote Poetry", sig_label = sig_poets_high),
  doldies_plot_high %>% mutate(Category = "\nBorn in 1800s", sig_label = sig_oldies_high),
  dbooks_plot_high %>% mutate(Category = "\n10+ Books\nWritten", sig_label = sig_books_high),
  dfemale_plot_high %>% mutate(Category = "\nWere Women", sig_label = sig_gender_high)
, .id = "id") %>%
  mutate(Category = factor(Category, levels = c('\nWrote Poetry', '\nBorn in 1800s', '\n10+ Books\nWritten', '\nWere Women')))

p_combined_high <- ggplot(df_combined_high, aes(x = Condition, y = freq*100, fill = Condition)) +
  geom_bar(stat="identity", width = 0.85, position = position_dodge(width = 0.7)) +
  geom_text(aes(label=paste0(sprintf("%.1f", freq*100),"%")),
            position=position_dodge(width=0.7), vjust=5, size = 5, color = "white") +
  geom_errorbar(aes(ymin=freq*100-se, ymax=freq*100+se), width = .1, position = position_dodge(width = 0.7)) +
  facet_wrap(~factor(Category, c('\nWrote Poetry', '\nBorn in 1800s', '\n10+ Books\nWritten', '\nWere Women')), nrow = 1, strip.position = "bottom") +
   geom_segment(data = df_combined_high %>% filter(Condition == "\"Treatment\""),
                aes(x = 1, xend = 2, y = freq*100 + se + 5, yend = freq*100 + se + 5),
                inherit.aes = FALSE) +
   geom_text(data = df_combined_high %>% filter(Condition == "\"Treatment\""),
             aes(x = 1.5, y = freq*100 + se + 7, label = sig_label),
             inherit.aes = FALSE, vjust = 0, size = 5) +
  theme_bw() +
  scale_fill_manual(values = c("#990000", "#011F5B"), labels = c("No feedback provided", "Feedback provided"), "Feedback") +
  scale_y_continuous(labels = function(x) paste0(x,"%"), limits = c(0,100)) +
  scale_x_discrete(labels = c("\"Control\"" = "Not\nShown", "\"Treatment\"" = "Shown")) +
  labs(x = "Feedback on % of authors who...", y = "% of New Authors with the Target Attribute",
       title = "High Base Condition (9 authors per category)") +
  theme(plot.caption = element_text(face = "italic"),
        legend.position = c(0.5, 0.95),
        legend.title = element_blank(),
        legend.direction = "horizontal",
        legend.text = element_text(size = 20),
        legend.key.size = unit(7, 'mm'),
        legend.background = element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid = element_blank(),
        panel.border = element_rect(fill= NA, color = "white"),
        plot.background = element_rect(fill = "white"),
        panel.background = element_rect(fill = "white"),
        axis.title.x = element_text(face="bold", size = 21, vjust = 17),
        plot.title = element_text(size = 18, hjust = 0.5),
        axis.title.y = element_text(size = 20, color = "black"),
        axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_text(size = 20, color = "black"),
        strip.text = element_text(size = 20, color = "black"),
        strip.background = element_rect(colour = "white", fill = "white"))

print(p_combined_high)
ggsave("Figure-Pilot-High.pdf", plot = p_combined_high, width = 10, height = 8, units = "in", device = cairo_pdf, family = "Times New Roman")
```


## System of Simultaneous Equations

### Low Base Condition

```{r results='markup'}
cat("LOW BASE CONDITION: Testing equality of attribute feedback effects\n\n")

# Poets - Low Base
poets.eqn_low <- list(
  poetseq = as.numeric(poets_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1,
  femaleeq = as.numeric(female_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1
)
restrict_poets <- "poetseq_poets_shown - femaleeq_gender_feedback = 0"
unrestricted_poets_low <- systemfit(poets.eqn_low, data=d0_low)

# Oldies - Low Base
oldies.eqn_low <- list(
  oldieseq = as.numeric(oldies_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1,
  femaleeq = as.numeric(female_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1
)
restrict_oldies <- "oldieseq_oldies_shown - femaleeq_gender_feedback = 0"
unrestricted_oldies_low <- systemfit(oldies.eqn_low, data=d0_low)

# Books - Low Base
books.eqn_low <- list(
  bookseq = as.numeric(books_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1,
  femaleeq = as.numeric(female_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1
)
restrict_books <- "bookseq_books_shown - femaleeq_gender_feedback = 0"
unrestricted_books_low <- systemfit(books.eqn_low, data=d0_low)

# Wald tests - Low Base
lh_result_poets_low = linearHypothesis(unrestricted_poets_low, restrict_poets)
lh_result_oldies_low = linearHypothesis(unrestricted_oldies_low, restrict_oldies)
lh_result_books_low = linearHypothesis(unrestricted_books_low, restrict_books)

# Collecting results - Low Base
poets_coef_low <- lh_result_poets_low$F[2]
oldies_coef_low <- lh_result_oldies_low$F[2]
books_coef_low <- lh_result_books_low$F[2]

p_value_poets_low = lh_result_poets_low$`Pr(>F)`[2]
p_value_oldies_low = lh_result_oldies_low$`Pr(>F)`[2]
p_value_books_low = lh_result_books_low$`Pr(>F)`[2]

# Summary table - Low Base
data.frame(
  `Test` = c("Gender Feedback - Poets Feedback", "Gender Feedback - Oldies Feedback", "Gender Feedback - Books Feedback"),
  `Wald Coefficient` = c(poets_coef_low, oldies_coef_low, books_coef_low),
  P_Value = c(p_value_poets_low, p_value_oldies_low, p_value_books_low),
  row.names = 1
)
```

\newpage

### Medium Base Condition

```{r results='markup'}
cat("MEDIUM BASE CONDITION: Testing equality of attribute feedback effects\n\n")

# Poets - Medium Base
poets.eqn_med <- list(
  poetseq = as.numeric(poets_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1,
  femaleeq = as.numeric(female_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1
)
unrestricted_poets_med <- systemfit(poets.eqn_med, data=d0_med)

# Oldies - Medium Base
oldies.eqn_med <- list(
  oldieseq = as.numeric(oldies_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1,
  femaleeq = as.numeric(female_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1
)
unrestricted_oldies_med <- systemfit(oldies.eqn_med, data=d0_med)

# Books - Medium Base
books.eqn_med <- list(
  bookseq = as.numeric(books_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1,
  femaleeq = as.numeric(female_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1
)
unrestricted_books_med <- systemfit(books.eqn_med, data=d0_med)

# Wald tests - Medium Base
lh_result_poets_med = linearHypothesis(unrestricted_poets_med, restrict_poets)
lh_result_oldies_med = linearHypothesis(unrestricted_oldies_med, restrict_oldies)
lh_result_books_med = linearHypothesis(unrestricted_books_med, restrict_books)

# Collecting results - Medium Base
poets_coef_med <- lh_result_poets_med$F[2]
oldies_coef_med <- lh_result_oldies_med$F[2]
books_coef_med <- lh_result_books_med$F[2]

p_value_poets_med = lh_result_poets_med$`Pr(>F)`[2]
p_value_oldies_med = lh_result_oldies_med$`Pr(>F)`[2]
p_value_books_med = lh_result_books_med$`Pr(>F)`[2]

# Summary table - Medium Base
data.frame(
  `Test` = c("Gender Feedback - Poets Feedback", "Gender Feedback - Oldies Feedback", "Gender Feedback - Books Feedback"),
  `Wald Coefficient` = c(poets_coef_med, oldies_coef_med, books_coef_med),
  P_Value = c(p_value_poets_med, p_value_oldies_med, p_value_books_med),
  row.names = 1
)
```

\newpage

### High Base Condition

```{r results='markup'}
cat("HIGH BASE CONDITION: Testing equality of attribute feedback effects\n\n")

# Poets - High Base
poets.eqn_high <- list(
  poetseq = as.numeric(poets_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1,
  femaleeq = as.numeric(female_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1
)
unrestricted_poets_high <- systemfit(poets.eqn_high, data=d0_high)

# Oldies - High Base
oldies.eqn_high <- list(
  oldieseq = as.numeric(oldies_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1,
  femaleeq = as.numeric(female_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1
)
unrestricted_oldies_high <- systemfit(oldies.eqn_high, data=d0_high)

# Books - High Base
books.eqn_high <- list(
  bookseq = as.numeric(books_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1,
  femaleeq = as.numeric(female_pick) ~ poets_shown + oldies_shown + books_shown + gender_feedback - 1
)
unrestricted_books_high <- systemfit(books.eqn_high, data=d0_high)

# Wald tests - High Base
lh_result_poets_high = linearHypothesis(unrestricted_poets_high, restrict_poets)
lh_result_oldies_high = linearHypothesis(unrestricted_oldies_high, restrict_oldies)
lh_result_books_high = linearHypothesis(unrestricted_books_high, restrict_books)

# Collecting results - High Base
poets_coef_high <- lh_result_poets_high$F[2]
oldies_coef_high <- lh_result_oldies_high$F[2]
books_coef_high <- lh_result_books_high$F[2]

p_value_poets_high = lh_result_poets_high$`Pr(>F)`[2]
p_value_oldies_high = lh_result_oldies_high$`Pr(>F)`[2]
p_value_books_high = lh_result_books_high$`Pr(>F)`[2]

# Summary table - High Base
data.frame(
  `Test` = c("Gender Feedback - Poets Feedback", "Gender Feedback - Oldies Feedback", "Gender Feedback - Books Feedback"),
  `Wald Coefficient` = c(poets_coef_high, oldies_coef_high, books_coef_high),
  P_Value = c(p_value_poets_high, p_value_oldies_high, p_value_books_high),
  row.names = 1
)
```